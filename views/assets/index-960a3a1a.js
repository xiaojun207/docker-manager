import{q as x,_ as v,o as g,c as w,t as c,r as u,z as T,w as d,b as r,a as i,e as f,p as A,f as L,d as $,k as z,B as P,C as I,F as R,j as S,G as j,H as E}from"./index-65c6c1a3.js";import{$ as M}from"./events-a8aa1a18.js";import{g as B}from"./task-ef938391.js";import{i as G}from"./echarts-e0333ef0.js";function N(){return x({url:"/mgr/dashboardSize",method:"get"})}function W(t){return x({url:"/mgr/containers/update",method:"post",data:t})}function H(t){return x({url:"/mgr/stats/update",method:"post",data:t})}let D=0;const F="webkit moz ms o".split(" ");let _,m;const K=typeof window>"u";if(K)_=function(){},m=function(){};else{_=window.requestAnimationFrame,m=window.cancelAnimationFrame;let t;for(let e=0;e<F.length&&!(_&&m);e++)t=F[e],_=_||window[t+"RequestAnimationFrame"],m=m||window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"];(!_||!m)&&(_=function(e){const a=new Date().getTime(),n=Math.max(0,16-(a-D)),s=window.setTimeout(()=>{e(a+n)},n);return D=a+n,s},m=function(e){window.clearTimeout(e)})}const J={props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:2017},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:0,validator(t){return t>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default(t,e,a,n){return a*(-Math.pow(2,-10*t/n)+1)*1024/1023+e}}},data(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown(){return this.startVal>this.endVal}},watch:{startVal(){this.autoplay&&this.start()},endVal(){this.autoplay&&this.start()}},mounted(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=_(this.count)},pauseResume(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause(){m(this.rAF)},resume(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,_(this.count)},reset(){this.startTime=null,m(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count(t){this.startTime||(this.startTime=t),this.timestamp=t;const e=t-this.startTime;this.remaining=this.localDuration-e,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(e,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(e,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(e/this.localDuration):this.printVal=this.localStartVal+(this.endVal-this.localStartVal)*(e/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),e<this.localDuration?this.rAF=_(this.count):this.$emit("callback")},isNumber(t){return!isNaN(parseFloat(t))},formatNumber(t){t=t.toFixed(this.decimals),t+="";const e=t.split(".");let a=e[0];const n=e.length>1?this.decimal+e[1]:"",s=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;s.test(a);)a=a.replace(s,"$1"+this.separator+"$2");return this.prefix+a+n+this.suffix}},destroyed(){m(this.rAF)}};function Q(t,e,a,n,s,l){return g(),w("span",null,c(s.displayValue),1)}const C=v(J,[["render",Q]]);function U(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),a.push.apply(a,n)}return a}C.unmounted=C.destroyed,Reflect.deleteProperty(C,"destroyed");var X=function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?O(Object(a),!0).forEach(function(n){U(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}({name:"CountTo",emits:["callback","mountedCallback"]},C);const Y={components:{CountTo:X},data(){return{dashboradSize:{serverConnected:0,server:0,container:1110,containerRun:0,image:0,task:0,app:0,follow:0}}},created(){this.fetchData()},mounted(){},methods:{handleSetLineChartData(t){M(this,"handleSetLineChartData",t)},fetchData(){this.listLoading=!0,N().then(t=>{this.dashboradSize=t.data,this.listLoading=!1})}},emits:["handleSetLineChartData"]},V=t=>(A("data-v-1012597a"),t=t(),L(),t),Z=V(()=>i("div",{class:"card-panel-icon-wrapper icon-people"},null,-1)),tt={class:"card-panel-description"},et={class:"card-panel-text"},at=V(()=>i("div",{class:"card-panel-icon-wrapper icon-message"},null,-1)),nt={class:"card-panel-description"},st={class:"card-panel-text"},rt=V(()=>i("div",{class:"card-panel-icon-wrapper icon-money"},null,-1)),it={class:"card-panel-description"},lt={class:"card-panel-text"},ot=V(()=>i("div",{class:"card-panel-icon-wrapper icon-image"},null,-1)),ct={class:"card-panel-description"},dt={class:"card-panel-text"},ut=V(()=>i("div",{class:"card-panel-icon-wrapper icon-app"},null,-1)),pt={class:"card-panel-description"},ht={class:"card-panel-text"},_t=V(()=>i("div",{class:"card-panel-icon-wrapper icon-log"},null,-1)),mt={class:"card-panel-description"},ft={class:"card-panel-text"};function vt(t,e,a,n,s,l){const o=u("count-to"),b=u("el-divider"),p=u("el-col"),h=u("el-row");return g(),T(h,{gutter:40,class:"panel-group"},{default:d(()=>[r(p,{xs:12,sm:12,lg:6,class:"card-panel-col",style:{display:"none"}},{default:d(()=>[i("div",{class:"card-panel",onClick:e[0]||(e[0]=y=>l.handleSetLineChartData("Server"))},[Z,i("div",tt,[i("div",et,c(t.$t("主机")),1),f(" "+c(t.$t("在线"))+" ",1),r(o,{startVal:0,endVal:s.dashboradSize.serverConnected,duration:3e3,class:"card-panel-num"},null,8,["endVal"]),r(b,{direction:"vertical"}),f(" "+c(t.$t("总计"))+" ",1),r(o,{startVal:0,endVal:s.dashboradSize.server,duration:3e3,class:"card-panel-num"},null,8,["endVal"])])])]),_:1}),r(p,{xs:12,sm:12,lg:6,class:"card-panel-col",style:{display:"none"}},{default:d(()=>[i("div",{class:"card-panel",onClick:e[1]||(e[1]=y=>l.handleSetLineChartData("Container"))},[at,i("div",nt,[i("div",st,c(t.$t("容器")),1),f(" "+c(t.$t("运行中"))+" ",1),r(o,{startVal:0,endVal:s.dashboradSize.containerRun,duration:3e3,class:"card-panel-num"},null,8,["endVal"]),r(b,{direction:"vertical"}),f(" "+c(t.$t("已停止"))+" ",1),r(o,{startVal:0,endVal:s.dashboradSize.container-s.dashboradSize.containerRun,duration:3e3,class:"card-panel-num",style:{color:"red"}},null,8,["endVal"])])])]),_:1}),r(p,{xs:12,sm:12,lg:6,class:"card-panel-col"},{default:d(()=>[i("div",{class:"card-panel",onClick:e[2]||(e[2]=y=>l.handleSetLineChartData("Task"))},[rt,i("div",it,[i("div",lt,c(t.$t("任务")),1),r(o,{startVal:0,endVal:s.dashboradSize.task,duration:3e3,class:"card-panel-num"},null,8,["endVal"])])])]),_:1}),r(p,{xs:12,sm:12,lg:6,class:"card-panel-col"},{default:d(()=>[i("div",{class:"card-panel",onClick:e[3]||(e[3]=y=>l.handleSetLineChartData("Image"))},[ot,i("div",ct,[i("div",dt,c(t.$t("镜像")),1),r(o,{startVal:0,endVal:s.dashboradSize.image,duration:10,class:"card-panel-num"},null,8,["endVal"])])])]),_:1}),r(p,{xs:12,sm:12,lg:6,class:"card-panel-col"},{default:d(()=>[i("div",{class:"card-panel",onClick:e[4]||(e[4]=y=>l.handleSetLineChartData("App"))},[ut,i("div",pt,[i("div",ht,c(t.$t("应用")),1),r(o,{startVal:0,endVal:s.dashboradSize.app,duration:10,class:"card-panel-num"},null,8,["endVal"])])])]),_:1}),r(p,{xs:12,sm:12,lg:6,class:"card-panel-col"},{default:d(()=>[i("div",{class:"card-panel",onClick:e[5]||(e[5]=y=>l.handleSetLineChartData("follow"))},[_t,i("div",mt,[i("div",ft,c(t.$t("实时日志开启数量")),1),r(o,{startVal:0,endVal:s.dashboradSize.follow,duration:3e3,class:"card-panel-num"},null,8,["endVal"])])])]),_:1})]),_:1})}const gt=v(Y,[["render",vt],["__scopeId","data-v-1012597a"]]),bt={data(){return{list:null}},created(){this.fetchData()},methods:{orderNoFilter_filter(t){return t},statusFilter_filter(t){return{"000000":"warning",100200:"success",100100:"danger"}[t]},fetchData(){B({currentPage:1,pageSize:10,total:0}).then(e=>{this.list=e.data.list})},statusFilter(t){return{"000000":this.$t("正在进行"),100200:this.$t("完成"),100100:this.$t("失败")}[t]}}};function Vt(t,e,a,n,s,l){const o=u("el-table-column"),b=u("el-tag"),p=u("el-table");return g(),T(p,{data:s.list,style:{width:"100%","padding-top":"15px","margin-left":"15px"}},{default:d(()=>[r(o,{label:t.$t("任务"),"min-width":"200"},{default:d(h=>[f(c(l.orderNoFilter_filter(h.row.Ch)),1)]),_:1},8,["label"]),r(o,{label:t.$t("目标主机"),width:"195",align:"center"},{default:d(h=>[f(c(h.row.ServerName),1)]),_:1},8,["label"]),r(o,{label:"Status",width:"100",align:"center"},{default:d(({row:h})=>[r(b,{type:l.statusFilter_filter(h.Code)},{default:d(()=>[f(c(l.statusFilter(h.Code)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])}const yt=v(bt,[["render",Vt]]),wt=$({__name:"index",props:{option:Object},setup(t){const e=t,a=z(null);return P(()=>{const n=a.value;if(n){let s=e.option,l=G(n);l.setOption(s),I("resize",()=>l.resize()),R(()=>e.option,o=>{l.setOption(o)},{deep:!0})}}),(n,s)=>(g(),w("div",{ref_key:"chart",ref:a,class:"chart"},null,512))}});const q=v(wt,[["__scopeId","data-v-ee55f80e"]]),Ct={title:{text:"浏览器占比变化",subtext:"纯属虚构",top:10,left:10},tooltip:{trigger:"item"},legend:{type:"scroll",bottom:10,data:function(){for(var t=[],e=1;e<=28;e++)t.push(e+2e3+"");return t}()},visualMap:{top:"middle",right:10,color:["red","yellow"],calculable:!0},radar:{indicator:[{text:"IE8-",max:400},{text:"IE9+",max:400},{text:"Safari",max:400},{text:"Firefox",max:400},{text:"Chrome",max:400}]},series:function(){for(var t=[],e=1;e<=28;e++)t.push({name:"浏览器（数据纯属虚构）",type:"radar",symbol:"none",lineStyle:{width:1},emphasis:{areaStyle:{color:"rgba(0,250,0,0.3)"}},data:[{value:[(40-e)*10,(38-e)*4+60,e*5+10,e*9,e*e/2],name:e+2e3+""}]});return t}()},St=$({components:{Chart:q},setup(){return{options:S(Ct)}}});const xt={class:"box"};function $t(t,e,a,n,s,l){const o=u("Chart");return g(),w("div",xt,[r(o,{option:t.options},null,8,["option"])])}const Dt=v(St,[["render",$t],["__scopeId","data-v-3998eb6e"]]);function k(t,e){return{title:{text:t},series:[{name:t,type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:2,borderColor:"#fff",borderWidth:10},color:["#0cd505","#ec0527"],label:{formatter:n=>n.name+" "+n.value},emphasis:{label:{show:!0,fontSize:"15",fontWeight:"bold",formatter:n=>n.name+" "+n.value}},data:e}]}}const Ft=$({components:{Chart:q},setup(){const{t}=j(),e=S(k(t("主机"),[{value:0,name:t("在线")},{value:0,name:t("离线")}])),a=S(k(t("容器"),[{value:0,name:t("运行中")},{value:0,name:t("已停止")}])),n=z({serverConnected:0,server:0,container:1110,containerRun:0,image:0,task:0,app:0,follow:0});return N().then(s=>{n.value=s.data;const l=n.value;e.series[0].data=[{value:l.serverConnected,name:t("在线")},{value:l.server-l.serverConnected,name:t("离线")}],a.series[0].data=[{value:l.containerRun,name:t("运行中")},{value:l.container-l.containerRun,name:t("已停止")}]}),{serverOptions:e,containerOptions:a}}});const Ot={class:"chart-container"},kt={class:"box"},Tt={class:"box"};function zt(t,e,a,n,s,l){const o=u("Chart");return g(),w("div",Ot,[i("div",kt,[r(o,{option:t.serverOptions},null,8,["option"])]),i("div",Tt,[r(o,{option:t.containerOptions},null,8,["option"])])])}const Nt=v(Ft,[["render",zt],["__scopeId","data-v-2c2c97b1"]]);const qt={name:"DashboardAdmin",components:{CircleChart:Nt,PieChart:Dt,PanelGroup:gt,TransactionTable:yt},data(){return{loading:!1,ElIconRefresh:E}},methods:{refreshContainerList(){this.loading=!0,W().then(t=>{this.loading=!1,this.$message(this.$t("刷新成功"))})},refreshContainerStats(){this.loading=!0,H().then(t=>{this.loading=!1,this.$message(this.$t("刷新成功"))})}}},At={class:"dashboard-editor-container"};function Lt(t,e,a,n,s,l){const o=u("CircleChart"),b=u("panel-group"),p=u("transaction-table"),h=u("el-row");return g(),w("div",At,[r(o),r(b),r(h,{style:{background:"#fff",padding:"16px 16px 0","margin-bottom":"32px"}},{default:d(()=>[r(p)]),_:1})])}const Et=v(qt,[["render",Lt],["__scopeId","data-v-657a3b96"]]);export{Et as default};
